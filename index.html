<!DOCTYPE html>
<html lang="en">
<head>
<audio id="background-audio" src="https://files.catbox.moe/7714uu.mp3" loop></audio>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Unsung Legend of Christopher Shreve AKA Tekken</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font for a more 'divine' feel */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Playfair+Display:wght@700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Dark gray background */
            color: #e2e8f0; /* Light gray text */
            position: relative;
            overflow-x: hidden; /* Prevent horizontal scrollbar from floating image */
            /* Ensure body covers full viewport for welcome modal positioning */
            min-height: 100vh;
        }

        h1, h2 {
            font-family: 'Playfair Display', serif;
        }

        /* Styles for the floating image */
        #floating-cursor-image {
            position: absolute;
            pointer-events: none;
            transform: translate(-50%, -50%);
            transition: transform 0.1s ease-out;
            z-index: 9999;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(255, 255, 0, 0.7);
            animation: pulse-glow 2s infinite alternate;
        }

        @keyframes pulse-glow {
            from { box-shadow: 0 0 10px rgba(255, 255, 0, 0.5); }
            to { box-shadow: 0 0 20px rgba(255, 255, 0, 0.9); }
        }

        /* Styles for the image modal/lightbox */
        #image-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }

        #image-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        #image-modal-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #modal-media-container { /* New container for dynamic media */
            max-width: 100%;
            max-height: 85vh;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            overflow: hidden; /* Ensure content respects border-radius */
        }

        #modal-media-container img,
        #modal-media-container video {
            max-width: 100%;
            max-height: 100%; /* Fill the container */
            object-fit: contain; /* Ensure media is fully visible */
            display: block; /* Remove extra space below inline elements */
        }


        #modal-caption {
            color: white;
            margin-top: 10px;
            font-size: 1.1rem;
            text-align: center;
        }

        #modal-close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 50%;
            transition: background-color 0.2s ease-in-out;
            z-index: 10001;
        }

        #modal-close-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* Styles for the Info Modal */
        #info-modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.75);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10001;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }

        #info-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        #info-modal-content {
            background-color: #2d3748; /* Darker gray for modal content */
            color: #e2e8f0; /* Light text for modal content */
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.3), 0 4px 6px rgba(0, 0, 0, 0.15);
            max-width: 32rem; /* approx 512px */
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        #info-modal-close-button {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: none;
            border: none;
            font-size: 2rem;
            color: #cbd5e0; /* light gray for close button */
            cursor: pointer;
            padding: 0.3125rem 0.625rem;
            border-radius: 50%;
            transition: background-color 0.2s ease-in-out;
            line-height: 1;
        }

        #info-modal-close-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Specific style for "NEW" badge */
        .new-badge {
            background-color: #EF4444; /* Tailwind red-500 */
            color: white;
            font-size: 0.75rem; /* text-xs */
            font-weight: bold;
            padding: 0.125rem 0.375rem; /* py-0.5 px-1.5 */
            border-radius: 0.25rem; /* rounded */
            margin-left: 0.5rem; /* ml-2 */
            animation: pulse-new 1.5s infinite;
        }

        @keyframes pulse-new {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Styles for the new Welcome Modal */
        #welcome-modal-overlay {
            position: fixed;
            inset: 0;
            background: linear-gradient(45deg, #1a202c, #2d3748, #1a202c);
            background-size: 400% 400%;
            animation: gradient-animation 15s ease infinite;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 20000; /* Higher than other modals */
            transition: opacity 0.5s ease-in-out, visibility 0.5s ease-in-out;
            opacity: 1;
            visibility: visible;
        }

        #welcome-modal-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }

        #welcome-modal-content {
            text-align: center;
            background-color: rgba(45, 55, 72, 0.9); /* Darker gray with some transparency */
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5), 0 5px 15px rgba(0, 0, 0, 0.3);
            max-width: 90%;
            width: 500px;
            border: 2px solid #dc2626; /* red-600 */
        }

        #welcome-enter-button {
            background-color: #dc2626; /* Tailwind red-600 */
            color: white;
            font-weight: bold;
            padding: 1rem 2.5rem;
            border-radius: 9999px; /* rounded-full */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease-in-out;
            border: none;
            cursor: pointer;
            font-size: 1.25rem; /* text-xl */
            animation: pulsate-button 2s infinite ease-in-out;
        }

        #welcome-enter-button:hover {
            background-color: #ef4444; /* Tailwind red-500 */
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes pulsate-button {
            0% { transform: scale(1); box-shadow: 0 0 0 rgba(220, 38, 38, 0.7); }
            50% { transform: scale(1.05); box-shadow: 0 0 20px rgba(220, 38, 38, 0.9); }
            100% { transform: scale(1); box-shadow: 0 0 0 rgba(220, 38, 38, 0.7); }
        }

        /* Styles for the new Games Modal */
        #games-modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.75);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10001; /* Same as info modal */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }

        #games-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        #games-modal-content {
            background-color: #2d3748; /* Darker gray for modal content */
            color: #e2e8f0; /* Light text for modal content */
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.3), 0 4px 6px rgba(0, 0, 0, 0.15);
            max-width: 24rem; /* Adjusted for games list */
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            text-align: center;
        }

        #games-modal-content a {
            display: flex;
            align-items: center;
            justify-content: center; /* Center content horizontally */
            background-color: #4a5568; /* Slightly lighter gray for game links */
            color: #e2e8f0;
            padding: 0.75rem 1.25rem;
            border-radius: 0.375rem;
            margin-bottom: 0.75rem;
            text-decoration: none;
            font-weight: bold;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out;
        }

        #games-modal-content a:hover {
            background-color: #636b77; /* Even lighter on hover */
            transform: translateY(-2px);
        }

        #games-modal-close-button {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: none;
            border: none;
            font-size: 2rem;
            color: #cbd5e0; /* light gray for close button */
            cursor: pointer;
            padding: 0.3125rem 0.625rem;
            border-radius: 50%;
            transition: background-color 0.2s ease-in-out;
            line-height: 1;
        }

        #games-modal-close-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="text-gray-200 antialiased">

    <div id="welcome-modal-overlay">
        <div id="welcome-modal-content">
            <h1 class="text-4xl md:text-5xl font-extrabold text-red-400 mb-6">
                Welcome, Fan!
            </h1>
            <p class="text-lg md:text-xl mb-8 leading-relaxed">
                Prepare to dive into the legendary world of Tekken.
            </p>
            <button id="welcome-enter-button">
                Enter Fan Club
            </button>
            
        </div>
    </div>

    <div id="floating-cursor-image" class="hidden md:block">
        <img src="https://i.imgur.com/WhMRCcm.png" alt="Floating icon" class="w-full h-full object-cover rounded-full">
    </div>

    <header class="relative bg-gradient-to-r from-gray-800 to-red-900 text-white py-16 px-4 md:px-8 overflow-hidden rounded-b-lg shadow-xl">
        <div class="container mx-auto flex flex-col md:flex-row items-center justify-between z-10 relative">
            <div class="text-center md:text-left mb-8 md:mb-0">
                <h1 class="text-4xl md:text-6xl font-extrabold mb-4 leading-tight rounded-lg p-2 bg-black bg-opacity-30 inline-block">
                    The Legend himself <span class="text-red-400">Tekken!</span>
                </h1>
                <p class="text-lg md:text-xl opacity-90 mt-2">
                    Welcome, fellow enthusiasts, to the official fan club page dedicated to the one and only Tekken! Join us in celebrating his everyday, relatable triumphs and bewildering blunders.
                </p>
                <button id="music-toggle-button" class="mt-4 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-300">
                    Pause Music
                </button>
            </div>
            <div id="main-image-container" class="w-48 h-48 md:w-64 md:h-64 flex-shrink-0 rounded-full overflow-hidden border-4 border-red-500 shadow-2xl transition duration-500 transform hover:scale-105 cursor-pointer">
                <img src="https://i.imgur.com/iTnsO02.png" alt="The Unsung Hero Christopher Shreve AKA Tekken" class="object-cover w-full h-full">
            </div>
        </div>
        <nav class="absolute bottom-4 left-1/2 -translate-x-1/2 z-20 flex space-x-4">
            <button id="open-games-modal-button" class="flex items-center bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-300">
                Tekken Games!
            </button>
        </nav>
        <div class="absolute inset-0 bg-white opacity-5 blur-3xl animate-pulse"></div>
    </header>

    <section id="quotes" class="py-16 px-4 md:px-8 bg-gray-900 rounded-lg shadow-md mx-auto my-8 max-w-5xl">
        <div class="container mx-auto">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-10 text-gray-100">Moments of Pure Tekken</h2>
            <div id="quote-display" class="bg-gradient-to-br from-yellow-800 to-orange-900 p-8 rounded-xl shadow-2xl border-2 border-orange-700 text-center relative overflow-hidden flex items-center justify-center" style="min-height: 400px;">
                <img id="quote-image" src="" alt="Tekken Moment" class="w-full h-full object-contain rounded-lg transition-opacity duration-700 ease-in-out opacity-0">
            </div>
        </div>
    </section>

    <section id="gallery" class="py-16 px-4 md:px-8 bg-gray-800 rounded-lg shadow-md mx-auto my-8 max-w-6xl">
        <div class="container mx-auto">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-10 text-gray-100">Moments He Thought Went Hard</h2>
            <div id="image-gallery-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">
                </div>
        </div>
    </section>

    <footer class="bg-gray-950 text-white py-8 px-4 md:px-8 text-center rounded-t-lg shadow-inner">
        <p class="text-lg mb-4">
            He did what this time? send it in.
        </p>
        <button id="contribute-button" class="inline-block bg-green-700 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-green-600 transition duration-300 transform hover:scale-105">
            Discord: jlaiii - discord.com / INCELS
        </button>
        <p class="text-sm opacity-70 mt-4">
            &copy; 2025 The Fan Club of Tekken. Probably not all rights reserved, he wouldn't care.
        </p>
        </footer>

    <div id="image-modal-overlay" class="image-modal-overlay">
        <div id="image-modal-content">
            <button id="modal-close-button">&times;</button>
            <div id="modal-media-container"></div> <p id="modal-caption"></p>
        </div>
    </div>

    <div id="info-modal-overlay" class="fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center z-[10001] opacity-0 invisible transition-opacity duration-300">
        <div id="info-modal-content" class="bg-white p-6 rounded-lg shadow-xl max-w-lg w-11/12 max-h-[90vh] overflow-y-auto relative">
            <button id="info-modal-close-button" class="absolute top-2 right-2 text-gray-600 hover:text-gray-900 text-3xl leading-none">&times;</button>
            <h3 class="text-2xl font-bold mb-4 text-gray-800">Information</h3>
            <div id="info-content" class="text-gray-700 text-base leading-relaxed">
                Loading information...
            </div>
        </div>
    </div>

    <div id="games-modal-overlay" class="fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center z-[10001] opacity-0 invisible transition-opacity duration-300">
        <div id="games-modal-content" class="bg-white p-6 rounded-lg shadow-xl max-w-lg w-11/12 max-h-[90vh] overflow-y-auto relative">
            <button id="games-modal-close-button" class="absolute top-2 right-2 text-gray-600 hover:text-gray-900 text-3xl leading-none">&times;</button>
            <h3 class="text-2xl font-bold mb-6 text-gray-100">Tekken Games!</h3>
            <div class="flex flex-col space-y-4">
                <a href="game.html">
                    Whack A TEKKEN! <span class="new-badge">NEW</span>
                </a>
                <a href="beer.html">
                    Grab Beers!
                </a>
                <a href="Trivia.html">
                    Tekken Trivia!
                </a>
                <a href="trash.html">
                    Clean his house! <span class="new-badge">NEW</span>
                </a>
            </div>
        </div>
    </div>

    <script>
        // --- Floating Cursor Image Management ---
        const floatingImage = document.getElementById('floating-cursor-image');

        document.addEventListener('mousemove', (e) => {
            floatingImage.style.left = `${e.clientX + window.scrollX}px`;
            floatingImage.style.top = `${e.clientY + window.scrollY}px`;
        });

        // --- Quotes Management (now image slideshow) ---
        const quoteImage = document.getElementById('quote-image');
        let slideshowImages = []; // Will be populated with image URLs
        let currentSlideshowIndex = 0; // To keep track of the current image

        /**
         * Fetches image URLs for the slideshow from a text file.
         * Assumes the text file is named 'quotes.txt' (can rename if desired)
         * Each line should be a direct URL to an image.
         */
        async function fetchSlideshowImages() {
            try {
                const response = await fetch('quotes.txt'); // Using quotes.txt as the source
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const text = await response.text();
                slideshowImages = text.split('\n')
                    .map(line => line.trim())
                    .filter(line => line.length > 0); // Only include non-empty lines

                if (slideshowImages.length > 0) {
                    displayNextSlideshowImage(true); // Display the first image immediately
                    setInterval(displayNextSlideshowImage, 7000); // Cycle every 7 seconds
                } else {
                    quoteImage.style.opacity = '1';
                    quoteImage.src = "https://placehold.co/600x400/cccccc/333333?text=No+Images+Yet"; // Placeholder
                    quoteImage.alt = "No images available";
                }
            } catch (error) {
                console.error('Error fetching slideshow images:', error);
                quoteImage.style.opacity = '1';
                quoteImage.src = "https://placehold.co/600x400/cccccc/333333?text=Error+Loading+Images"; // Placeholder
                quoteImage.alt = "Error loading images";
            }
        }

        /**
         * Displays the next image in the slideshow with fade effect.
         * @param {boolean} initialLoad - True if it's the first image being displayed.
         */
        function displayNextSlideshowImage(initialLoad = false) {
            if (slideshowImages.length === 0) return;

            // Fade out current image
            quoteImage.style.opacity = '0';

            // Wait for fade out, then change content and fade in
            setTimeout(() => {
                const imageUrl = slideshowImages[currentSlideshowIndex];

                // Update image source and alt text
                quoteImage.src = imageUrl;
                quoteImage.alt = `Tekken Moment ${currentSlideshowIndex + 1}`; // Generic alt text for cycling images

                // Fallback for image loading errors
                quoteImage.onerror = function() {
                    this.src = `https://placehold.co/${this.width || 600}x${this.height || 400}/cccccc/333333?text=Image+Error`;
                    this.alt = "Slideshow image failed to load";
                    console.error("Failed to load slideshow image:", imageUrl);
                };

                // Fade in new image
                quoteImage.style.opacity = '1';

                currentSlideshowIndex = (currentSlideshowIndex + 1) % slideshowImages.length;
            }, 700); // This delay should match your CSS transition duration for a smooth fade.
        }

        // --- Image Gallery Management ---
        const galleryContainer = document.getElementById('image-gallery-container');
        let gloriousMedia = []; // Renamed to gloriousMedia as it will hold images and videos

        /**
         * Fetches media data from a text file and loads them into the gallery.
         * Assumes the text file is named 'images.txt' in the same directory.
         * Each line should be formatted as: mediaUrl|type:image|caption or mediaUrl|type:video|caption
         */
        async function fetchImages() {
            try {
                const response = await fetch('images.txt');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const text = await response.text();
                // Parse each line into a media object
                gloriousMedia = text.split('\n')
                    .map(line => line.trim())
                    .filter(line => line.length > 0)
                    .map(line => {
                        const parts = line.split('|');
                        return {
                            src: parts[0] ? parts[0].trim() : '',
                            type: parts[1] && parts[1].includes('type:') ? parts[1].split(':')[1].trim() : 'image', // Default to image if not specified
                            caption: parts[2] ? parts[2].trim() : '' // Set caption to empty string if not provided
                        };
                    })
                    .filter(media => media.src); // Only include if src is present

                loadAllMedia(); // Load media into the DOM after fetching
            } catch (error) {
                console.error('Error fetching images:', error);
                galleryContainer.innerHTML = '<p class="text-center text-red-500">Failed to load media. Please check "images.txt".</p>';
            }
        }

        /**
         * Loads all media from the `gloriousMedia` array into the gallery.
         */
        function loadAllMedia() {
            galleryContainer.innerHTML = ''; // Clear existing content to prevent duplicates on reload
            gloriousMedia.forEach(media => {
                const mediaWrapper = document.createElement('div');
                mediaWrapper.className = 'bg-gray-700 p-2 rounded-xl shadow-md transform hover:scale-105 transition duration-300 cursor-pointer flex flex-col';

                let mediaElement;
                if (media.type === 'video') {
                    mediaElement = document.createElement('video');
                    mediaElement.src = media.src;
                    mediaElement.className = 'w-full h-auto rounded-lg mb-2 object-cover';
                    mediaElement.controls = false; // Controls off for thumbnail
                    mediaElement.muted = true; // Mute for autoplay on hover if desired (not implemented here)
                    mediaElement.autoplay = false; // No autoplay in gallery thumbnail
                    mediaElement.loop = true; // Loop for thumbnail preview if you want (not implemented here)
                    mediaElement.preload = 'metadata'; // Load just enough to get dimensions/thumbnail
                    // Add a play icon overlay if you want to indicate it's a video
                    const playIcon = document.createElement('div');
                    playIcon.innerHTML = '<svg class="absolute inset-0 w-1/3 h-1/3 m-auto text-white opacity-80" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path></svg>';
                    playIcon.className = 'absolute inset-0 flex items-center justify-center';
                    mediaWrapper.style.position = 'relative'; // Enable absolute positioning for icon
                    mediaWrapper.appendChild(mediaElement);
                    mediaWrapper.appendChild(playIcon);


                    mediaElement.onerror = function() {
                        this.src = `https://placehold.co/${this.width || 300}x${this.height || 200}/cccccc/333333?text=Video+Error`;
                        console.error("Failed to load video:", media.src);
                    };

                } else { // Default to image if type is not video (handles images and GIFs)
                    mediaElement = document.createElement('img');
                    mediaElement.src = media.src;
                    mediaElement.alt = media.caption;
                    mediaElement.className = 'w-full h-auto rounded-lg mb-2 object-cover';
                    mediaElement.onerror = function() {
                        this.src = `https://placehold.co/${this.width || 300}x${this.height || 200}/cccccc/333333?text=Image+Error`;
                        this.alt = "Media failed to load";
                        console.error("Failed to load image:", media.src);
                    };
                    mediaWrapper.appendChild(mediaElement);
                }


                // Only create and append caption element if there's a caption to display
                if (media.caption) {
                    const captionElement = document.createElement('p');
                    captionElement.className = 'text-sm text-center text-gray-300';
                    captionElement.textContent = media.caption;
                    mediaWrapper.appendChild(captionElement);
                }

                galleryContainer.appendChild(mediaWrapper);

                // Add click listener to open modal
                mediaWrapper.addEventListener('click', () => {
                    openImageModal(media.src, media.type, media.caption);
                });
            });
        }

        // --- Image Modal Logic ---
        const imageModalOverlay = document.getElementById('image-modal-overlay');
        const modalMediaContainer = document.getElementById('modal-media-container'); // Changed to container
        const modalCaption = document.getElementById('modal-caption');
        const modalCloseButton = document.getElementById('modal-close-button');

        /**
         * Opens the full-screen media modal.
         * @param {string} src - The URL of the media to display.
         * @param {string} type - The type of media ('image' or 'video').
         * @param {string} caption - The caption to display below the media.
         */
        function openImageModal(src, type, caption) {
            // Clear previous media
            modalMediaContainer.innerHTML = '';

            let modalMediaElement;
            if (type === 'video') {
                modalMediaElement = document.createElement('video');
                modalMediaElement.src = src;
                modalMediaElement.controls = true; // Enable controls for modal video
                modalMediaElement.autoplay = true; // Autoplay video in modal
                modalMediaElement.loop = true; // Loop video in modal
                modalMediaElement.setAttribute('playsinline', ''); // For iOS autoplay
                modalMediaElement.className = 'w-full h-full object-contain rounded-lg'; // Apply styles
                modalMediaElement.onerror = function() {
                    console.error("Failed to load modal video:", src);
                    // Optionally display a placeholder or error message
                };
            } else { // Default to image (handles images and GIFs)
                modalMediaElement = document.createElement('img');
                modalMediaElement.src = src;
                modalMediaElement.alt = caption;
                modalMediaElement.className = 'w-full h-full object-contain rounded-lg'; // Apply styles
                modalMediaElement.onerror = function() {
                    console.error("Failed to load modal image:", src);
                    // Optionally display a placeholder or error message
                };
            }

            modalMediaContainer.appendChild(modalMediaElement);

            // Only set modalCaption text if caption is provided, otherwise clear it and hide the element
            if (caption) {
                modalCaption.textContent = caption;
                modalCaption.style.display = 'block'; // Ensure it's visible if there's content
            } else {
                modalCaption.textContent = '';
                modalCaption.style.display = 'none'; // Hide the caption element if no text
            }

            imageModalOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        /**
         * Closes the full-screen image modal.
         */
        function closeImageModal() {
            imageModalOverlay.classList.remove('active');
            document.body.style.overflow = '';
            modalMediaContainer.innerHTML = ''; // Clear media from modal
            modalCaption.textContent = '';
            modalCaption.style.display = 'block'; // Reset display to default for next open
        }

        // Event listeners for closing the modal
        modalCloseButton.addEventListener('click', closeImageModal);
        imageModalOverlay.addEventListener('click', (e) => {
            if (e.target === imageModalOverlay) {
                closeImageModal();
            }
        });
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && imageModalOverlay.classList.contains('active')) {
                closeImageModal();
            }
        });

        // --- Contribute Button Logic ---
        const contributeButton = document.getElementById('contribute-button');
        if (contributeButton) {
            contributeButton.addEventListener('click', () => {
                window.open('https://discord.com/invite/INCELS', '_blank'); // Opens in a new tab
            });
        }

        // --- Info Button and Modal Logic (repurposed for main image click) ---
        const mainImageContainer = document.getElementById('main-image-container'); // Get the main image container
        const infoModalOverlay = document.getElementById('info-modal-overlay');
        const infoModalCloseButton = document.getElementById('info-modal-close-button');
        const infoContent = document.getElementById('info-content');

        // Event listener for clicking the main image
        if (mainImageContainer) {
            mainImageContainer.addEventListener('click', () => {
                openInfoModal();
            });
        }

        if (infoModalCloseButton) {
            infoModalCloseButton.addEventListener('click', () => {
                closeInfoModal();
            });
        }

        if (infoModalOverlay) {
            infoModalOverlay.addEventListener('click', (e) => {
                if (e.target === infoModalOverlay) {
                    closeInfoModal();
                }
            });
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && infoModalOverlay.classList.contains('active')) {
                closeInfoModal();
            }
        });


        /**
         * Opens the info modal and fetches content from info.txt.
         */
        async function openInfoModal() {
            infoModalOverlay.classList.add('active');
            infoModalOverlay.style.opacity = '1';
            infoModalOverlay.style.visibility = 'visible';
            document.body.style.overflow = 'hidden'; // Prevent scrolling body when modal is open

            try {
                const response = await fetch('info.txt');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const text = await response.text();
                infoContent.textContent = text;
            } catch (error) {
                console.error('Error fetching info.txt:', error);
                infoContent.textContent = "Failed to load information. Please ensure 'info.txt' exists.";
            }
        }

        /**
         * Closes the info modal.
         */
        function closeInfoModal() {
            infoModalOverlay.classList.remove('active');
            infoModalOverlay.style.opacity = '0';
            infoModalOverlay.style.visibility = 'hidden';
            document.body.style.overflow = ''; // Restore body scrolling
            infoContent.textContent = "Loading information..."; // Reset content
        }


        // --- Background Audio Control ---
        const backgroundAudio = document.getElementById('background-audio');
        const musicToggleButton = document.getElementById('music-toggle-button');
        const welcomeModalOverlay = document.getElementById('welcome-modal-overlay');
        const welcomeEnterButton = document.getElementById('welcome-enter-button');

        let isPlaying = false; // Audio starts paused until user clicks 'Enter'

        // Function to attempt playing audio
        function tryPlayAudio() {
            backgroundAudio.play().then(() => {
                isPlaying = true;
                musicToggleButton.textContent = 'Pause Music';
                console.log("Music started successfully.");
            }).catch(e => {
                console.log("Autoplay prevented or failed:", e);
                backgroundAudio.pause(); // Ensure it's paused if autoplay fails
                isPlaying = false;
                musicToggleButton.textContent = 'Play Music';
            });
        }

        // Event listener for the Welcome modal's Enter button
        if (welcomeEnterButton) {
            welcomeEnterButton.addEventListener('click', () => {
                welcomeModalOverlay.classList.add('hidden'); // Hide the welcome modal
                document.body.style.overflow = ''; // Re-enable scrolling
                tryPlayAudio(); // Attempt to play music
            });
        }

        // Existing music toggle button logic
        if (musicToggleButton && backgroundAudio) {
            musicToggleButton.addEventListener('click', () => {
                if (isPlaying) {
                    backgroundAudio.pause();
                    musicToggleButton.textContent = 'Play Music';
                } else {
                    tryPlayAudio(); // Use the common play function
                }
                isPlaying = !isPlaying; // Toggle the state
            });

            // Handle potential autoplay blocking by browsers
            backgroundAudio.addEventListener('play', () => {
                isPlaying = true;
                musicToggleButton.textContent = 'Pause Music';
            });

            backgroundAudio.addEventListener('pause', () => {
                isPlaying = false;
                musicToggleButton.textContent = 'Play Music';
            });
        }

        // --- Games Modal Logic ---
        const gamesModalOverlay = document.getElementById('games-modal-overlay');
        const gamesModalCloseButton = document.getElementById('games-modal-close-button');
        const openGamesModalButton = document.getElementById('open-games-modal-button');

        if (openGamesModalButton) {
            openGamesModalButton.addEventListener('click', () => {
                openGamesModal();
            });
        }

        if (gamesModalCloseButton) {
            gamesModalCloseButton.addEventListener('click', () => {
                closeGamesModal();
            });
        }

        if (gamesModalOverlay) {
            gamesModalOverlay.addEventListener('click', (e) => {
                if (e.target === gamesModalOverlay) {
                    closeGamesModal();
                }
            });
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && gamesModalOverlay.classList.contains('active')) {
                closeGamesModal();
            }
        });

        function openGamesModal() {
            gamesModalOverlay.classList.add('active');
            document.body.style.overflow = 'hidden'; // Prevent scrolling body when modal is open
        }

        function closeGamesModal() {
            gamesModalOverlay.classList.remove('active');
            document.body.style.overflow = ''; // Restore body scrolling
        }


        // Initial fetch and load when the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            fetchSlideshowImages(); // Call the new function for the slideshow
            fetchImages(); // Keep this for your gallery section

            // Display the welcome modal on initial load, prevent scrolling
            welcomeModalOverlay.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        });
    </script>

</body>
</html>